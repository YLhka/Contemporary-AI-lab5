Training started at: 2026-01-28 14:25:58
Command: train_clipfusion_full.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 16 --lr 1e-5 --freeze-clip --output-dir results/clipfusion/lr1e-5_bs16_freeze --output best_clipfusion_lr1e-5_bs16_freeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0825 | Val loss: 1.0630
Val macro-F1: 0.5389 | Val weighted-F1: 0.6365 | Val acc: 0.6288

Classification Report:
              precision    recall  f1-score   support

    positive     0.8274    0.6318    0.7165       478
    negative     0.4930    0.7395    0.5916       238
     neutral     0.3205    0.2976    0.3086        84

    accuracy                         0.6288       800
   macro avg     0.5470    0.5563    0.5389       800
weighted avg     0.6747    0.6288    0.6365       800


Confusion Matrix:
[[302 136  40]
 [ 49 176  13]
 [ 14  45  25]]

Saved best model: best_clipfusion_lr1e-5_bs16_freeze.pt
===== Epoch 2 =====
Train loss: 1.0480 | Val loss: 1.0305
Val macro-F1: 0.5843 | Val weighted-F1: 0.6945 | Val acc: 0.6963

Classification Report:
              precision    recall  f1-score   support

    positive     0.7996    0.7762    0.7877       478
    negative     0.6007    0.6765    0.6364       238
     neutral     0.3676    0.2976    0.3289        84

    accuracy                         0.6963       800
   macro avg     0.5893    0.5834    0.5843       800
weighted avg     0.6951    0.6963    0.6945       800


Confusion Matrix:
[[371  75  32]
 [ 66 161  11]
 [ 27  32  25]]

Saved best model: best_clipfusion_lr1e-5_bs16_freeze.pt
===== Epoch 3 =====
Train loss: 1.0147 | Val loss: 0.9995
Val macro-F1: 0.5907 | Val weighted-F1: 0.6957 | Val acc: 0.6913

Classification Report:
              precision    recall  f1-score   support

    positive     0.8382    0.7259    0.7780       478
    negative     0.5855    0.7479    0.6568       238
     neutral     0.3415    0.3333    0.3373        84

    accuracy                         0.6913       800
   macro avg     0.5884    0.6024    0.5907       800
weighted avg     0.7109    0.6913    0.6957       800


Confusion Matrix:
[[347  91  40]
 [ 46 178  14]
 [ 21  35  28]]

Saved best model: best_clipfusion_lr1e-5_bs16_freeze.pt
===== Epoch 4 =====
Train loss: 0.9797 | Val loss: 0.9717
Val macro-F1: 0.5884 | Val weighted-F1: 0.6963 | Val acc: 0.6887

Classification Report:
              precision    recall  f1-score   support

    positive     0.8337    0.7343    0.7809       478
    negative     0.6071    0.7143    0.6564       238
     neutral     0.3030    0.3571    0.3279        84

    accuracy                         0.6887       800
   macro avg     0.5813    0.6019    0.5884       800
weighted avg     0.7106    0.6887    0.6963       800


Confusion Matrix:
[[351  75  52]
 [ 51 170  17]
 [ 19  35  30]]

Early stopping counter: 1/3
===== Epoch 5 =====
Train loss: 0.9520 | Val loss: 0.9470
Val macro-F1: 0.5834 | Val weighted-F1: 0.6910 | Val acc: 0.6837

Classification Report:
              precision    recall  f1-score   support

    positive     0.8244    0.7364    0.7779       478
    negative     0.6022    0.6933    0.6445       238
     neutral     0.3030    0.3571    0.3279        84

    accuracy                         0.6837       800
   macro avg     0.5765    0.5956    0.5834       800
weighted avg     0.7035    0.6837    0.6910       800


Confusion Matrix:
[[352  74  52]
 [ 56 165  17]
 [ 19  35  30]]

Early stopping counter: 2/3
===== Epoch 6 =====
Train loss: 0.9247 | Val loss: 0.9270
Val macro-F1: 0.5987 | Val weighted-F1: 0.7014 | Val acc: 0.6913

Classification Report:
              precision    recall  f1-score   support

    positive     0.8443    0.7259    0.7807       478
    negative     0.6187    0.7227    0.6667       238
     neutral     0.3063    0.4048    0.3487        84

    accuracy                         0.6913       800
   macro avg     0.5898    0.6178    0.5987       800
weighted avg     0.7207    0.6913    0.7014       800


Confusion Matrix:
[[347  74  57]
 [ 46 172  20]
 [ 18  32  34]]

Saved best model: best_clipfusion_lr1e-5_bs16_freeze.pt
===== Epoch 7 =====
Train loss: 0.9055 | Val loss: 0.9123
Val macro-F1: 0.6067 | Val weighted-F1: 0.7051 | Val acc: 0.6937

Classification Report:
              precision    recall  f1-score   support

    positive     0.8498    0.7218    0.7805       478
    negative     0.6268    0.7269    0.6732       238
     neutral     0.3136    0.4405    0.3663        84

    accuracy                         0.6937       800
   macro avg     0.5967    0.6297    0.6067       800
weighted avg     0.7271    0.6937    0.7051       800


Confusion Matrix:
[[345  73  60]
 [ 44 173  21]
 [ 17  30  37]]

Saved best model: best_clipfusion_lr1e-5_bs16_freeze.pt
===== Epoch 8 =====
Train loss: 0.8918 | Val loss: 0.9020
Val macro-F1: 0.6010 | Val weighted-F1: 0.7028 | Val acc: 0.6900

Classification Report:
              precision    recall  f1-score   support

    positive     0.8550    0.7155    0.7790       478
    negative     0.6259    0.7311    0.6744       238
     neutral     0.2951    0.4286    0.3495        84

    accuracy                         0.6900       800
   macro avg     0.5920    0.6250    0.6010       800
weighted avg     0.7281    0.6900    0.7028       800


Confusion Matrix:
[[342  73  63]
 [ 41 174  23]
 [ 17  31  36]]

Early stopping counter: 1/3
===== Epoch 9 =====
Train loss: 0.8815 | Val loss: 0.8963
Val macro-F1: 0.6002 | Val weighted-F1: 0.7007 | Val acc: 0.6875

Classification Report:
              precision    recall  f1-score   support

    positive     0.8507    0.7155    0.7773       478
    negative     0.6264    0.7185    0.6693       238
     neutral     0.2960    0.4405    0.3541        84

    accuracy                         0.6875       800
   macro avg     0.5910    0.6248    0.6002       800
weighted avg     0.7257    0.6875    0.7007       800


Confusion Matrix:
[[342  72  64]
 [ 43 171  24]
 [ 17  30  37]]

Early stopping counter: 2/3
===== Epoch 10 =====
Train loss: 0.8768 | Val loss: 0.8945
Val macro-F1: 0.6022 | Val weighted-F1: 0.7018 | Val acc: 0.6875

Classification Report:
              precision    recall  f1-score   support

    positive     0.8582    0.7092    0.7766       478
    negative     0.6268    0.7269    0.6732       238
     neutral     0.2946    0.4524    0.3568        84

    accuracy                         0.6875       800
   macro avg     0.5932    0.6295    0.6022       800
weighted avg     0.7302    0.6875    0.7018       800


Confusion Matrix:
[[339  72  67]
 [ 41 173  24]
 [ 15  31  38]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/clipfusion/lr1e-5_bs16_freeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.6067 | Final val weighted-F1: 0.7051 | Final val acc: 0.6937

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.8498    0.7218    0.7805       478
    negative     0.6268    0.7269    0.6732       238
     neutral     0.3136    0.4405    0.3663        84

    accuracy                         0.6937       800
   macro avg     0.5967    0.6297    0.6067       800
weighted avg     0.7271    0.6937    0.7051       800


Final Confusion Matrix:
[[345  73  60]
 [ 44 173  21]
 [ 17  30  37]]

===== Error Analysis =====
Total misclassified samples: 245
Error rate: 0.3063
Saved error analysis to: results/clipfusion/lr1e-5_bs16_freeze\error_analysis.json
Saved final report to: results/clipfusion/lr1e-5_bs16_freeze\final_report.txt

All results saved to: results/clipfusion/lr1e-5_bs16_freeze
