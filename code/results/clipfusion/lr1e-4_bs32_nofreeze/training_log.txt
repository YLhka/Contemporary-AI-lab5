Training started at: 2026-01-28 14:10:23
Command: train_clipfusion_full.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 32 --lr 1e-4 --output-dir results/clipfusion/lr1e-4_bs32_nofreeze --output best_clipfusion_lr1e-4_bs32_nofreeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0662 | Val loss: 1.0886
Val macro-F1: 0.3378 | Val weighted-F1: 0.4536 | Val acc: 0.4800

Classification Report:
              precision    recall  f1-score   support

    positive     0.8255    0.3661    0.5072       478
    negative     0.3554    0.8782    0.5061       238
     neutral     0.0000    0.0000    0.0000        84

    accuracy                         0.4800       800
   macro avg     0.3936    0.4148    0.3378       800
weighted avg     0.5990    0.4800    0.4536       800


Confusion Matrix:
[[175 303   0]
 [ 29 209   0]
 [  8  76   0]]

Saved best model: best_clipfusion_lr1e-4_bs32_nofreeze.pt
===== Epoch 2 =====
Train loss: 1.0240 | Val loss: 1.0026
Val macro-F1: 0.4712 | Val weighted-F1: 0.4928 | Val acc: 0.5038

Classification Report:
              precision    recall  f1-score   support

    positive     0.8359    0.3410    0.4844       478
    negative     0.4019    0.8697    0.5498       238
     neutral     0.3667    0.3929    0.3793        84

    accuracy                         0.5038       800
   macro avg     0.5348    0.5345    0.4712       800
weighted avg     0.6575    0.5038    0.4928       800


Confusion Matrix:
[[163 269  46]
 [ 20 207  11]
 [ 12  39  33]]

Saved best model: best_clipfusion_lr1e-4_bs32_nofreeze.pt
===== Epoch 3 =====
Train loss: 0.8576 | Val loss: 1.0390
Val macro-F1: 0.4683 | Val weighted-F1: 0.5475 | Val acc: 0.5325

Classification Report:
              precision    recall  f1-score   support

    positive     0.6957    0.5690    0.6260       478
    negative     0.4542    0.5000    0.4760       238
     neutral     0.2381    0.4167    0.3030        84

    accuracy                         0.5325       800
   macro avg     0.4626    0.4952    0.4683       800
weighted avg     0.5758    0.5325    0.5475       800


Confusion Matrix:
[[272 123  83]
 [ 90 119  29]
 [ 29  20  35]]

Early stopping counter: 1/3
===== Epoch 4 =====
Train loss: 0.6274 | Val loss: 1.1978
Val macro-F1: 0.4767 | Val weighted-F1: 0.5486 | Val acc: 0.5463

Classification Report:
              precision    recall  f1-score   support

    positive     0.8080    0.4665    0.5915       478
    negative     0.4248    0.8067    0.5565       238
     neutral     0.3056    0.2619    0.2821        84

    accuracy                         0.5463       800
   macro avg     0.5128    0.5117    0.4767       800
weighted avg     0.6412    0.5463    0.5486       800


Confusion Matrix:
[[223 214  41]
 [ 37 192   9]
 [ 16  46  22]]

Saved best model: best_clipfusion_lr1e-4_bs32_nofreeze.pt
===== Epoch 5 =====
Train loss: 0.4442 | Val loss: 1.4154
Val macro-F1: 0.4923 | Val weighted-F1: 0.5918 | Val acc: 0.5962

Classification Report:
              precision    recall  f1-score   support

    positive     0.6897    0.7113    0.7003       478
    negative     0.4713    0.4832    0.4772       238
     neutral     0.3492    0.2619    0.2993        84

    accuracy                         0.5962       800
   macro avg     0.5034    0.4855    0.4923       800
weighted avg     0.5890    0.5962    0.5918       800


Confusion Matrix:
[[340 102  36]
 [118 115   5]
 [ 35  27  22]]

Saved best model: best_clipfusion_lr1e-4_bs32_nofreeze.pt
===== Epoch 6 =====
Train loss: 0.3788 | Val loss: 1.6618
Val macro-F1: 0.4955 | Val weighted-F1: 0.5861 | Val acc: 0.5800

Classification Report:
              precision    recall  f1-score   support

    positive     0.7123    0.6423    0.6755       478
    negative     0.4710    0.5462    0.5058       238
     neutral     0.2903    0.3214    0.3051        84

    accuracy                         0.5800       800
   macro avg     0.4912    0.5033    0.4955       800
weighted avg     0.5962    0.5800    0.5861       800


Confusion Matrix:
[[307 124  47]
 [ 89 130  19]
 [ 35  22  27]]

Saved best model: best_clipfusion_lr1e-4_bs32_nofreeze.pt
===== Epoch 7 =====
Train loss: 0.3439 | Val loss: 1.5706
Val macro-F1: 0.5009 | Val weighted-F1: 0.5954 | Val acc: 0.5900

Classification Report:
              precision    recall  f1-score   support

    positive     0.7382    0.6192    0.6735       478
    negative     0.4811    0.6429    0.5504       238
     neutral     0.2840    0.2738    0.2788        84

    accuracy                         0.5900       800
   macro avg     0.5011    0.5120    0.5009       800
weighted avg     0.6140    0.5900    0.5954       800


Confusion Matrix:
[[296 134  48]
 [ 75 153  10]
 [ 30  31  23]]

Saved best model: best_clipfusion_lr1e-4_bs32_nofreeze.pt
===== Epoch 8 =====
Train loss: 0.3202 | Val loss: 1.8652
Val macro-F1: 0.4806 | Val weighted-F1: 0.5692 | Val acc: 0.5675

Classification Report:
              precision    recall  f1-score   support

    positive     0.7595    0.5418    0.6325       478
    negative     0.4392    0.7437    0.5523       238
     neutral     0.3214    0.2143    0.2571        84

    accuracy                         0.5675       800
   macro avg     0.5067    0.4999    0.4806       800
weighted avg     0.6182    0.5675    0.5692       800


Confusion Matrix:
[[259 185  34]
 [ 57 177   4]
 [ 25  41  18]]

Early stopping counter: 1/3
===== Epoch 9 =====
Train loss: 0.3061 | Val loss: 1.8001
Val macro-F1: 0.5012 | Val weighted-F1: 0.5973 | Val acc: 0.5925

Classification Report:
              precision    recall  f1-score   support

    positive     0.7431    0.6172    0.6743       478
    negative     0.4831    0.6597    0.5577       238
     neutral     0.2821    0.2619    0.2716        84

    accuracy                         0.5925       800
   macro avg     0.5027    0.5129    0.5012       800
weighted avg     0.6173    0.5925    0.5973       800


Confusion Matrix:
[[295 136  47]
 [ 72 157   9]
 [ 30  32  22]]

Saved best model: best_clipfusion_lr1e-4_bs32_nofreeze.pt
===== Epoch 10 =====
Train loss: 0.2937 | Val loss: 1.8296
Val macro-F1: 0.5041 | Val weighted-F1: 0.6016 | Val acc: 0.5975

Classification Report:
              precision    recall  f1-score   support

    positive     0.7384    0.6318    0.6809       478
    negative     0.4904    0.6471    0.5580       238
     neutral     0.2857    0.2619    0.2733        84

    accuracy                         0.5975       800
   macro avg     0.5048    0.5136    0.5041       800
weighted avg     0.6171    0.5975    0.6016       800


Confusion Matrix:
[[302 129  47]
 [ 76 154   8]
 [ 31  31  22]]

Saved best model: best_clipfusion_lr1e-4_bs32_nofreeze.pt
Saved metrics to: results/clipfusion/lr1e-4_bs32_nofreeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.5041 | Final val weighted-F1: 0.6016 | Final val acc: 0.5975

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.7384    0.6318    0.6809       478
    negative     0.4904    0.6471    0.5580       238
     neutral     0.2857    0.2619    0.2733        84

    accuracy                         0.5975       800
   macro avg     0.5048    0.5136    0.5041       800
weighted avg     0.6171    0.5975    0.6016       800


Final Confusion Matrix:
[[302 129  47]
 [ 76 154   8]
 [ 31  31  22]]

===== Error Analysis =====
Total misclassified samples: 322
Error rate: 0.4025
Saved error analysis to: results/clipfusion/lr1e-4_bs32_nofreeze\error_analysis.json
Saved final report to: results/clipfusion/lr1e-4_bs32_nofreeze\final_report.txt

All results saved to: results/clipfusion/lr1e-4_bs32_nofreeze
