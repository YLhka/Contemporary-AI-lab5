Training started at: 2026-01-28 15:27:22
Command: train_clipfusion_full.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 16 --lr 5e-5 --freeze-clip --output-dir results/clipfusion/lr5e-5_bs16_freeze --output best_clipfusion_lr5e-5_bs16_freeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0477 | Val loss: 0.9646
Val macro-F1: 0.5184 | Val weighted-F1: 0.5921 | Val acc: 0.5813

Classification Report:
              precision    recall  f1-score   support

    positive     0.9456    0.4728    0.6304       478
    negative     0.4769    0.8655    0.6149       238
     neutral     0.2558    0.3929    0.3099        84

    accuracy                         0.5813       800
   macro avg     0.5594    0.5771    0.5184       800
weighted avg     0.7337    0.5813    0.5921       800


Confusion Matrix:
[[226 179  73]
 [  9 206  23]
 [  4  47  33]]

Saved best model: best_clipfusion_lr5e-5_bs16_freeze.pt
===== Epoch 2 =====
Train loss: 0.8729 | Val loss: 0.8140
Val macro-F1: 0.6073 | Val weighted-F1: 0.7049 | Val acc: 0.6887

Classification Report:
              precision    recall  f1-score   support

    positive     0.8907    0.6820    0.7725       478
    negative     0.6200    0.7815    0.6914       238
     neutral     0.2910    0.4643    0.3578        84

    accuracy                         0.6887       800
   macro avg     0.6006    0.6426    0.6073       800
weighted avg     0.7472    0.6887    0.7049       800


Confusion Matrix:
[[326  83  69]
 [ 26 186  26]
 [ 14  31  39]]

Saved best model: best_clipfusion_lr5e-5_bs16_freeze.pt
===== Epoch 3 =====
Train loss: 0.7568 | Val loss: 0.7637
Val macro-F1: 0.6115 | Val weighted-F1: 0.7086 | Val acc: 0.6913

Classification Report:
              precision    recall  f1-score   support

    positive     0.8940    0.6883    0.7778       478
    negative     0.6267    0.7689    0.6906       238
     neutral     0.2929    0.4881    0.3661        84

    accuracy                         0.6913       800
   macro avg     0.6045    0.6484    0.6115       800
weighted avg     0.7514    0.6913    0.7086       800


Confusion Matrix:
[[329  79  70]
 [ 26 183  29]
 [ 13  30  41]]

Saved best model: best_clipfusion_lr5e-5_bs16_freeze.pt
===== Epoch 4 =====
Train loss: 0.6905 | Val loss: 0.7447
Val macro-F1: 0.6446 | Val weighted-F1: 0.7434 | Val acc: 0.7325

Classification Report:
              precision    recall  f1-score   support

    positive     0.8594    0.7803    0.8180       478
    negative     0.7095    0.7185    0.7140       238
     neutral     0.3360    0.5000    0.4019        84

    accuracy                         0.7325       800
   macro avg     0.6350    0.6663    0.6446       800
weighted avg     0.7599    0.7325    0.7434       800


Confusion Matrix:
[[373  50  55]
 [ 39 171  28]
 [ 22  20  42]]

Saved best model: best_clipfusion_lr5e-5_bs16_freeze.pt
===== Epoch 5 =====
Train loss: 0.6512 | Val loss: 0.7321
Val macro-F1: 0.6437 | Val weighted-F1: 0.7394 | Val acc: 0.7275

Classification Report:
              precision    recall  f1-score   support

    positive     0.8646    0.7615    0.8098       478
    negative     0.6972    0.7353    0.7157       238
     neutral     0.3359    0.5119    0.4057        84

    accuracy                         0.7275       800
   macro avg     0.6326    0.6696    0.6437       800
weighted avg     0.7593    0.7275    0.7394       800


Confusion Matrix:
[[364  57  57]
 [ 35 175  28]
 [ 22  19  43]]

Early stopping counter: 1/3
===== Epoch 6 =====
Train loss: 0.6152 | Val loss: 0.7231
Val macro-F1: 0.6374 | Val weighted-F1: 0.7278 | Val acc: 0.7087

Classification Report:
              precision    recall  f1-score   support

    positive     0.8785    0.7259    0.7950       478
    negative     0.6983    0.7101    0.7042       238
     neutral     0.3129    0.6071    0.4130        84

    accuracy                         0.7087       800
   macro avg     0.6299    0.6811    0.6374       800
weighted avg     0.7655    0.7087    0.7278       800


Confusion Matrix:
[[347  56  75]
 [ 32 169  37]
 [ 16  17  51]]

Early stopping counter: 2/3
===== Epoch 7 =====
Train loss: 0.5966 | Val loss: 0.7249
Val macro-F1: 0.6411 | Val weighted-F1: 0.7295 | Val acc: 0.7163

Classification Report:
              precision    recall  f1-score   support

    positive     0.8725    0.7301    0.7950       478
    negative     0.6692    0.7479    0.7063       238
     neutral     0.3433    0.5476    0.4220        84

    accuracy                         0.7162       800
   macro avg     0.6283    0.6752    0.6411       800
weighted avg     0.7564    0.7163    0.7295       800


Confusion Matrix:
[[349  68  61]
 [ 33 178  27]
 [ 18  20  46]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/clipfusion/lr5e-5_bs16_freeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.6446 | Final val weighted-F1: 0.7434 | Final val acc: 0.7325

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.8594    0.7803    0.8180       478
    negative     0.7095    0.7185    0.7140       238
     neutral     0.3360    0.5000    0.4019        84

    accuracy                         0.7325       800
   macro avg     0.6350    0.6663    0.6446       800
weighted avg     0.7599    0.7325    0.7434       800


Final Confusion Matrix:
[[373  50  55]
 [ 39 171  28]
 [ 22  20  42]]

===== Error Analysis =====
Total misclassified samples: 214
Error rate: 0.2675
Saved error analysis to: results/clipfusion/lr5e-5_bs16_freeze\error_analysis.json
Saved final report to: results/clipfusion/lr5e-5_bs16_freeze\final_report.txt

All results saved to: results/clipfusion/lr5e-5_bs16_freeze
