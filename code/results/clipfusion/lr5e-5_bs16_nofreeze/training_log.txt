Training started at: 2026-01-28 15:37:17
Command: train_clipfusion_full.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 16 --lr 5e-5 --output-dir results/clipfusion/lr5e-5_bs16_nofreeze --output best_clipfusion_lr5e-5_bs16_nofreeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0731 | Val loss: 1.0832
Val macro-F1: 0.3317 | Val weighted-F1: 0.4549 | Val acc: 0.4713

Classification Report:
              precision    recall  f1-score   support

    positive     0.7263    0.4163    0.5293       478
    negative     0.3384    0.7479    0.4660       238
     neutral     0.0000    0.0000    0.0000        84

    accuracy                         0.4713       800
   macro avg     0.3549    0.3881    0.3317       800
weighted avg     0.5346    0.4713    0.4549       800


Confusion Matrix:
[[199 279   0]
 [ 60 178   0]
 [ 15  69   0]]

Saved best model: best_clipfusion_lr5e-5_bs16_nofreeze.pt
===== Epoch 2 =====
Train loss: 1.0656 | Val loss: 1.0801
Val macro-F1: 0.3716 | Val weighted-F1: 0.5150 | Val acc: 0.5300

Classification Report:
              precision    recall  f1-score   support

    positive     0.6832    0.5774    0.6259       478
    negative     0.3740    0.6176    0.4659       238
     neutral     0.3333    0.0119    0.0230        84

    accuracy                         0.5300       800
   macro avg     0.4635    0.4023    0.3716       800
weighted avg     0.5545    0.5300    0.5150       800


Confusion Matrix:
[[276 201   1]
 [ 90 147   1]
 [ 38  45   1]]

Saved best model: best_clipfusion_lr5e-5_bs16_nofreeze.pt
===== Epoch 3 =====
Train loss: 1.0082 | Val loss: 1.0584
Val macro-F1: 0.3414 | Val weighted-F1: 0.4186 | Val acc: 0.4462

Classification Report:
              precision    recall  f1-score   support

    positive     0.8081    0.2908    0.4277       478
    negative     0.3679    0.8950    0.5214       238
     neutral     0.1020    0.0595    0.0752        84

    accuracy                         0.4462       800
   macro avg     0.4260    0.4151    0.3414       800
weighted avg     0.6030    0.4462    0.4186       800


Confusion Matrix:
[[139 298  41]
 [ 22 213   3]
 [ 11  68   5]]

Early stopping counter: 1/3
===== Epoch 4 =====
Train loss: 0.9006 | Val loss: 1.1196
Val macro-F1: 0.4500 | Val weighted-F1: 0.5457 | Val acc: 0.5325

Classification Report:
              precision    recall  f1-score   support

    positive     0.7647    0.5167    0.6167       478
    negative     0.4263    0.6681    0.5205       238
     neutral     0.1923    0.2381    0.2128        84

    accuracy                         0.5325       800
   macro avg     0.4611    0.4743    0.4500       800
weighted avg     0.6039    0.5325    0.5457       800


Confusion Matrix:
[[247 178  53]
 [ 48 159  31]
 [ 28  36  20]]

Saved best model: best_clipfusion_lr5e-5_bs16_nofreeze.pt
===== Epoch 5 =====
Train loss: 0.7485 | Val loss: 1.0704
Val macro-F1: 0.4666 | Val weighted-F1: 0.5679 | Val acc: 0.5763

Classification Report:
              precision    recall  f1-score   support

    positive     0.6761    0.7469    0.7097       478
    negative     0.5593    0.2773    0.3708       238
     neutral     0.2468    0.4524    0.3193        84

    accuracy                         0.5763       800
   macro avg     0.4941    0.4922    0.4666       800
weighted avg     0.5963    0.5763    0.5679       800


Confusion Matrix:
[[357  43  78]
 [134  66  38]
 [ 37   9  38]]

Saved best model: best_clipfusion_lr5e-5_bs16_nofreeze.pt
===== Epoch 6 =====
Train loss: 0.5513 | Val loss: 1.1753
Val macro-F1: 0.4790 | Val weighted-F1: 0.5443 | Val acc: 0.5225

Classification Report:
              precision    recall  f1-score   support

    positive     0.7655    0.4916    0.5987       478
    negative     0.4585    0.5798    0.5121       238
     neutral     0.2344    0.5357    0.3261        84

    accuracy                         0.5225       800
   macro avg     0.4861    0.5357    0.4790       800
weighted avg     0.6184    0.5225    0.5443       800


Confusion Matrix:
[[235 142 101]
 [ 54 138  46]
 [ 18  21  45]]

Saved best model: best_clipfusion_lr5e-5_bs16_nofreeze.pt
===== Epoch 7 =====
Train loss: 0.3822 | Val loss: 1.3938
Val macro-F1: 0.4660 | Val weighted-F1: 0.5397 | Val acc: 0.5188

Classification Report:
              precision    recall  f1-score   support

    positive     0.7587    0.5000    0.6028       478
    negative     0.4357    0.5840    0.4991       238
     neutral     0.2229    0.4405    0.2960        84

    accuracy                         0.5188       800
   macro avg     0.4725    0.5082    0.4660       800
weighted avg     0.6064    0.5188    0.5397       800


Confusion Matrix:
[[239 154  85]
 [ 55 139  44]
 [ 21  26  37]]

Early stopping counter: 1/3
===== Epoch 8 =====
Train loss: 0.3271 | Val loss: 1.5026
Val macro-F1: 0.4779 | Val weighted-F1: 0.5617 | Val acc: 0.5400

Classification Report:
              precision    recall  f1-score   support

    positive     0.7445    0.5669    0.6437       478
    negative     0.4674    0.5126    0.4890       238
     neutral     0.2229    0.4643    0.3012        84

    accuracy                         0.5400       800
   macro avg     0.4783    0.5146    0.4779       800
weighted avg     0.6073    0.5400    0.5617       800


Confusion Matrix:
[[271 119  88]
 [ 68 122  48]
 [ 25  20  39]]

Early stopping counter: 2/3
===== Epoch 9 =====
Train loss: 0.3132 | Val loss: 1.5643
Val macro-F1: 0.4750 | Val weighted-F1: 0.5621 | Val acc: 0.5437

Classification Report:
              precision    recall  f1-score   support

    positive     0.7358    0.5941    0.6574       478
    negative     0.4436    0.4790    0.4606       238
     neutral     0.2357    0.4405    0.3071        84

    accuracy                         0.5437       800
   macro avg     0.4717    0.5045    0.4750       800
weighted avg     0.5963    0.5437    0.5621       800


Confusion Matrix:
[[284 122  72]
 [ 76 114  48]
 [ 26  21  37]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/clipfusion/lr5e-5_bs16_nofreeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.4790 | Final val weighted-F1: 0.5443 | Final val acc: 0.5225

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.7655    0.4916    0.5987       478
    negative     0.4585    0.5798    0.5121       238
     neutral     0.2344    0.5357    0.3261        84

    accuracy                         0.5225       800
   macro avg     0.4861    0.5357    0.4790       800
weighted avg     0.6184    0.5225    0.5443       800


Final Confusion Matrix:
[[235 142 101]
 [ 54 138  46]
 [ 18  21  45]]

===== Error Analysis =====
Total misclassified samples: 382
Error rate: 0.4775
Saved error analysis to: results/clipfusion/lr5e-5_bs16_nofreeze\error_analysis.json
Saved final report to: results/clipfusion/lr5e-5_bs16_nofreeze\final_report.txt

All results saved to: results/clipfusion/lr5e-5_bs16_nofreeze
