Training started at: 2026-01-28 14:00:21
Command: train_clipfusion_full.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 32 --lr 1e-4 --freeze-clip --output-dir results/clipfusion/lr1e-4_bs32_freeze --output best_clipfusion_lr1e-4_bs32_freeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0381 | Val loss: 0.9304
Val macro-F1: 0.5286 | Val weighted-F1: 0.5949 | Val acc: 0.5825

Classification Report:
              precision    recall  f1-score   support

    positive     0.9526    0.4623    0.6225       478
    negative     0.5000    0.8613    0.6327       238
     neutral     0.2532    0.4762    0.3306        84

    accuracy                         0.5825       800
   macro avg     0.5686    0.6000    0.5286       800
weighted avg     0.7445    0.5825    0.5949       800


Confusion Matrix:
[[221 165  92]
 [  7 205  26]
 [  4  40  40]]

Saved best model: best_clipfusion_lr1e-4_bs32_freeze.pt
===== Epoch 2 =====
Train loss: 0.8269 | Val loss: 0.7825
Val macro-F1: 0.6012 | Val weighted-F1: 0.6909 | Val acc: 0.6700

Classification Report:
              precision    recall  f1-score   support

    positive     0.9080    0.6402    0.7509       478
    negative     0.6106    0.7773    0.6839       238
     neutral     0.2812    0.5357    0.3689        84

    accuracy                         0.6700       800
   macro avg     0.5999    0.6511    0.6012       800
weighted avg     0.7537    0.6700    0.6909       800


Confusion Matrix:
[[306  87  85]
 [ 23 185  30]
 [  8  31  45]]

Saved best model: best_clipfusion_lr1e-4_bs32_freeze.pt
===== Epoch 3 =====
Train loss: 0.7088 | Val loss: 0.7528
Val macro-F1: 0.6284 | Val weighted-F1: 0.7219 | Val acc: 0.7075

Classification Report:
              precision    recall  f1-score   support

    positive     0.9011    0.7050    0.7911       478
    negative     0.6275    0.7857    0.6978       238
     neutral     0.3281    0.5000    0.3962        84

    accuracy                         0.7075       800
   macro avg     0.6189    0.6636    0.6284       800
weighted avg     0.7595    0.7075    0.7219       800


Confusion Matrix:
[[337  80  61]
 [ 26 187  25]
 [ 11  31  42]]

Saved best model: best_clipfusion_lr1e-4_bs32_freeze.pt
===== Epoch 4 =====
Train loss: 0.6351 | Val loss: 0.7417
Val macro-F1: 0.6454 | Val weighted-F1: 0.7455 | Val acc: 0.7362

Classification Report:
              precision    recall  f1-score   support

    positive     0.8601    0.7845    0.8206       478
    negative     0.7045    0.7311    0.7175       238
     neutral     0.3419    0.4762    0.3980        84

    accuracy                         0.7362       800
   macro avg     0.6355    0.6639    0.6454       800
weighted avg     0.7594    0.7362    0.7455       800


Confusion Matrix:
[[375  53  50]
 [ 37 174  27]
 [ 24  20  40]]

Saved best model: best_clipfusion_lr1e-4_bs32_freeze.pt
===== Epoch 5 =====
Train loss: 0.5921 | Val loss: 0.7275
Val macro-F1: 0.6529 | Val weighted-F1: 0.7367 | Val acc: 0.7212

Classification Report:
              precision    recall  f1-score   support

    positive     0.8822    0.7364    0.8027       478
    negative     0.6880    0.7227    0.7049       238
     neutral     0.3510    0.6310    0.4511        84

    accuracy                         0.7212       800
   macro avg     0.6404    0.6967    0.6529       800
weighted avg     0.7687    0.7212    0.7367       800


Confusion Matrix:
[[352  62  64]
 [ 32 172  34]
 [ 15  16  53]]

Saved best model: best_clipfusion_lr1e-4_bs32_freeze.pt
===== Epoch 6 =====
Train loss: 0.5568 | Val loss: 0.7258
Val macro-F1: 0.6338 | Val weighted-F1: 0.7192 | Val acc: 0.6963

Classification Report:
              precision    recall  f1-score   support

    positive     0.8992    0.6904    0.7811       478
    negative     0.6840    0.7185    0.7008       238
     neutral     0.3060    0.6667    0.4195        84

    accuracy                         0.6963       800
   macro avg     0.6297    0.6918    0.6338       800
weighted avg     0.7729    0.6963    0.7192       800


Confusion Matrix:
[[330  61  87]
 [ 27 171  40]
 [ 10  18  56]]

Early stopping counter: 1/3
===== Epoch 7 =====
Train loss: 0.5258 | Val loss: 0.7383
Val macro-F1: 0.6429 | Val weighted-F1: 0.7359 | Val acc: 0.7212

Classification Report:
              precision    recall  f1-score   support

    positive     0.8787    0.7427    0.8050       478
    negative     0.6848    0.7395    0.7111       238
     neutral     0.3309    0.5476    0.4126        84

    accuracy                         0.7212       800
   macro avg     0.6315    0.6766    0.6429       800
weighted avg     0.7635    0.7212    0.7359       800


Confusion Matrix:
[[355  62  61]
 [ 30 176  32]
 [ 19  19  46]]

Early stopping counter: 2/3
===== Epoch 8 =====
Train loss: 0.5060 | Val loss: 0.7491
Val macro-F1: 0.6317 | Val weighted-F1: 0.7282 | Val acc: 0.7137

Classification Report:
              precision    recall  f1-score   support

    positive     0.8941    0.7238    0.8000       478
    negative     0.6466    0.7689    0.7025       238
     neutral     0.3231    0.5000    0.3925        84

    accuracy                         0.7138       800
   macro avg     0.6213    0.6643    0.6317       800
weighted avg     0.7605    0.7137    0.7282       800


Confusion Matrix:
[[346  74  58]
 [ 25 183  30]
 [ 16  26  42]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/clipfusion/lr1e-4_bs32_freeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.6529 | Final val weighted-F1: 0.7367 | Final val acc: 0.7212

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.8822    0.7364    0.8027       478
    negative     0.6880    0.7227    0.7049       238
     neutral     0.3510    0.6310    0.4511        84

    accuracy                         0.7212       800
   macro avg     0.6404    0.6967    0.6529       800
weighted avg     0.7687    0.7212    0.7367       800


Final Confusion Matrix:
[[352  62  64]
 [ 32 172  34]
 [ 15  16  53]]

===== Error Analysis =====
Total misclassified samples: 223
Error rate: 0.2787
Saved error analysis to: results/clipfusion/lr1e-4_bs32_freeze\error_analysis.json
Saved final report to: results/clipfusion/lr1e-4_bs32_freeze\final_report.txt

All results saved to: results/clipfusion/lr1e-4_bs32_freeze
