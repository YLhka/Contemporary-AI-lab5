Training started at: 2026-01-28 15:00:27
Command: train_clipfusion_full.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 32 --lr 1e-5 --output-dir results/clipfusion/lr1e-5_bs32_nofreeze --output best_clipfusion_lr1e-5_bs32_nofreeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0498 | Val loss: 0.9544
Val macro-F1: 0.5051 | Val weighted-F1: 0.5595 | Val acc: 0.5463

Classification Report:
              precision    recall  f1-score   support

    positive     0.8861    0.4393    0.5874       478
    negative     0.4621    0.7689    0.5773       238
     neutral     0.2635    0.5238    0.3506        84

    accuracy                         0.5463       800
   macro avg     0.5372    0.5773    0.5051       800
weighted avg     0.6946    0.5463    0.5595       800


Confusion Matrix:
[[210 178  90]
 [ 22 183  33]
 [  5  35  44]]

Saved best model: best_clipfusion_lr1e-5_bs32_nofreeze.pt
===== Epoch 2 =====
Train loss: 0.7989 | Val loss: 0.8312
Val macro-F1: 0.5782 | Val weighted-F1: 0.6707 | Val acc: 0.6613

Classification Report:
              precision    recall  f1-score   support

    positive     0.9094    0.6088    0.7293       478
    negative     0.5476    0.8697    0.6721       238
     neutral     0.3039    0.3690    0.3333        84

    accuracy                         0.6613       800
   macro avg     0.5870    0.6159    0.5782       800
weighted avg     0.7382    0.6613    0.6707       800


Confusion Matrix:
[[291 129  58]
 [ 18 207  13]
 [ 11  42  31]]

Saved best model: best_clipfusion_lr1e-5_bs32_nofreeze.pt
===== Epoch 3 =====
Train loss: 0.4154 | Val loss: 0.8195
Val macro-F1: 0.6083 | Val weighted-F1: 0.6894 | Val acc: 0.6725

Classification Report:
              precision    recall  f1-score   support

    positive     0.8952    0.6255    0.7365       478
    negative     0.6186    0.8109    0.7018       238
     neutral     0.2987    0.5476    0.3866        84

    accuracy                         0.6725       800
   macro avg     0.6042    0.6614    0.6083       800
weighted avg     0.7503    0.6725    0.6894       800


Confusion Matrix:
[[299  92  87]
 [ 24 193  21]
 [ 11  27  46]]

Saved best model: best_clipfusion_lr1e-5_bs32_nofreeze.pt
===== Epoch 4 =====
Train loss: 0.1731 | Val loss: 0.9339
Val macro-F1: 0.6148 | Val weighted-F1: 0.7130 | Val acc: 0.7025

Classification Report:
              precision    recall  f1-score   support

    positive     0.8105    0.7782    0.7940       478
    negative     0.7184    0.6218    0.6667       238
     neutral     0.3111    0.5000    0.3836        84

    accuracy                         0.7025       800
   macro avg     0.6133    0.6334    0.6148       800
weighted avg     0.7307    0.7025    0.7130       800


Confusion Matrix:
[[372  41  65]
 [ 62 148  28]
 [ 25  17  42]]

Saved best model: best_clipfusion_lr1e-5_bs32_nofreeze.pt
===== Epoch 5 =====
Train loss: 0.0739 | Val loss: 1.2312
Val macro-F1: 0.6002 | Val weighted-F1: 0.7181 | Val acc: 0.7238

Classification Report:
              precision    recall  f1-score   support

    positive     0.7903    0.8201    0.8049       478
    negative     0.6891    0.6891    0.6891       238
     neutral     0.3485    0.2738    0.3067        84

    accuracy                         0.7237       800
   macro avg     0.6093    0.5943    0.6002       800
weighted avg     0.7138    0.7238    0.7181       800


Confusion Matrix:
[[392  52  34]
 [ 65 164   9]
 [ 39  22  23]]

Early stopping counter: 1/3
===== Epoch 6 =====
Train loss: 0.0399 | Val loss: 1.2888
Val macro-F1: 0.6037 | Val weighted-F1: 0.7171 | Val acc: 0.7225

Classification Report:
              precision    recall  f1-score   support

    positive     0.7780    0.8285    0.8024       478
    negative     0.7104    0.6597    0.6841       238
     neutral     0.3571    0.2976    0.3247        84

    accuracy                         0.7225       800
   macro avg     0.6152    0.5952    0.6037       800
weighted avg     0.7137    0.7225    0.7171       800


Confusion Matrix:
[[396  45  37]
 [ 73 157   8]
 [ 40  19  25]]

Early stopping counter: 2/3
===== Epoch 7 =====
Train loss: 0.0267 | Val loss: 1.4475
Val macro-F1: 0.6029 | Val weighted-F1: 0.7222 | Val acc: 0.7312

Classification Report:
              precision    recall  f1-score   support

    positive     0.7711    0.8598    0.8131       478
    negative     0.7438    0.6345    0.6848       238
     neutral     0.3594    0.2738    0.3108        84

    accuracy                         0.7312       800
   macro avg     0.6248    0.5894    0.6029       800
weighted avg     0.7198    0.7312    0.7222       800


Confusion Matrix:
[[411  34  33]
 [ 79 151   8]
 [ 43  18  23]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/clipfusion/lr1e-5_bs32_nofreeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.6148 | Final val weighted-F1: 0.7130 | Final val acc: 0.7025

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.8105    0.7782    0.7940       478
    negative     0.7184    0.6218    0.6667       238
     neutral     0.3111    0.5000    0.3836        84

    accuracy                         0.7025       800
   macro avg     0.6133    0.6334    0.6148       800
weighted avg     0.7307    0.7025    0.7130       800


Final Confusion Matrix:
[[372  41  65]
 [ 62 148  28]
 [ 25  17  42]]

===== Error Analysis =====
Total misclassified samples: 238
Error rate: 0.2975
Saved error analysis to: results/clipfusion/lr1e-5_bs32_nofreeze\error_analysis.json
Saved final report to: results/clipfusion/lr1e-5_bs32_nofreeze\final_report.txt

All results saved to: results/clipfusion/lr1e-5_bs32_nofreeze
