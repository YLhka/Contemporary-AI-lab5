Training started at: 2026-01-28 13:40:11
Command: train_clipfusion_full.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 16 --lr 1e-4 --freeze-clip --output-dir results/clipfusion/lr1e-4_bs16_freeze --output best_clipfusion_lr1e-4_bs16_freeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0047 | Val loss: 0.8646
Val macro-F1: 0.5545 | Val weighted-F1: 0.6329 | Val acc: 0.6225

Classification Report:
              precision    recall  f1-score   support

    positive     0.9440    0.5293    0.6783       478
    negative     0.5072    0.8866    0.6453       238
     neutral     0.2931    0.4048    0.3400        84

    accuracy                         0.6225       800
   macro avg     0.5814    0.6069    0.5545       800
weighted avg     0.7457    0.6225    0.6329       800


Confusion Matrix:
[[253 159  66]
 [ 11 211  16]
 [  4  46  34]]

Saved best model: best_clipfusion_lr1e-4_bs16_freeze.pt
===== Epoch 2 =====
Train loss: 0.7702 | Val loss: 0.7526
Val macro-F1: 0.6235 | Val weighted-F1: 0.7187 | Val acc: 0.7025

Classification Report:
              precision    recall  f1-score   support

    positive     0.9022    0.6946    0.7849       478
    negative     0.6373    0.7899    0.7054       238
     neutral     0.3066    0.5000    0.3801        84

    accuracy                         0.7025       800
   macro avg     0.6153    0.6615    0.6235       800
weighted avg     0.7608    0.7025    0.7187       800


Confusion Matrix:
[[332  79  67]
 [ 22 188  28]
 [ 14  28  42]]

Saved best model: best_clipfusion_lr1e-4_bs16_freeze.pt
===== Epoch 3 =====
Train loss: 0.6615 | Val loss: 0.7324
Val macro-F1: 0.6238 | Val weighted-F1: 0.7112 | Val acc: 0.6887

Classification Report:
              precision    recall  f1-score   support

    positive     0.9162    0.6632    0.7694       478
    negative     0.6512    0.7689    0.7052       238
     neutral     0.2948    0.6071    0.3969        84

    accuracy                         0.6887       800
   macro avg     0.6207    0.6797    0.6238       800
weighted avg     0.7721    0.6887    0.7112       800


Confusion Matrix:
[[317  74  87]
 [ 20 183  35]
 [  9  24  51]]

Saved best model: best_clipfusion_lr1e-4_bs16_freeze.pt
===== Epoch 4 =====
Train loss: 0.5913 | Val loss: 0.7454
Val macro-F1: 0.6447 | Val weighted-F1: 0.7467 | Val acc: 0.7388

Classification Report:
              precision    recall  f1-score   support

    positive     0.8581    0.7971    0.8265       478
    negative     0.7008    0.7185    0.7095       238
     neutral     0.3482    0.4643    0.3980        84

    accuracy                         0.7388       800
   macro avg     0.6357    0.6599    0.6447       800
weighted avg     0.7578    0.7388    0.7467       800


Confusion Matrix:
[[381  53  44]
 [ 38 171  29]
 [ 25  20  39]]

Saved best model: best_clipfusion_lr1e-4_bs16_freeze.pt
===== Epoch 5 =====
Train loss: 0.5398 | Val loss: 0.7603
Val macro-F1: 0.6455 | Val weighted-F1: 0.7441 | Val acc: 0.7362

Classification Report:
              precision    recall  f1-score   support

    positive     0.8780    0.7678    0.8192       478
    negative     0.6619    0.7731    0.7132       238
     neutral     0.3654    0.4524    0.4043        84

    accuracy                         0.7362       800
   macro avg     0.6351    0.6644    0.6455       800
weighted avg     0.7599    0.7362    0.7441       800


Confusion Matrix:
[[367  68  43]
 [ 31 184  23]
 [ 20  26  38]]

Saved best model: best_clipfusion_lr1e-4_bs16_freeze.pt
===== Epoch 6 =====
Train loss: 0.4940 | Val loss: 0.7580
Val macro-F1: 0.6360 | Val weighted-F1: 0.7354 | Val acc: 0.7225

Classification Report:
              precision    recall  f1-score   support

    positive     0.8818    0.7490    0.8100       478
    negative     0.6679    0.7521    0.7075       238
     neutral     0.3254    0.4881    0.3905        84

    accuracy                         0.7225       800
   macro avg     0.6250    0.6631    0.6360       800
weighted avg     0.7597    0.7225    0.7354       800


Confusion Matrix:
[[358  65  55]
 [ 29 179  30]
 [ 19  24  41]]

Early stopping counter: 1/3
===== Epoch 7 =====
Train loss: 0.4681 | Val loss: 0.7867
Val macro-F1: 0.6323 | Val weighted-F1: 0.7324 | Val acc: 0.7225

Classification Report:
              precision    recall  f1-score   support

    positive     0.8872    0.7406    0.8073       478
    negative     0.6382    0.7857    0.7043       238
     neutral     0.3426    0.4405    0.3854        84

    accuracy                         0.7225       800
   macro avg     0.6227    0.6556    0.6323       800
weighted avg     0.7560    0.7225    0.7324       800


Confusion Matrix:
[[354  78  46]
 [ 26 187  25]
 [ 19  28  37]]

Early stopping counter: 2/3
===== Epoch 8 =====
Train loss: 0.4444 | Val loss: 0.7937
Val macro-F1: 0.6253 | Val weighted-F1: 0.7266 | Val acc: 0.7150

Classification Report:
              precision    recall  f1-score   support

    positive     0.8744    0.7427    0.8032       478
    negative     0.6486    0.7521    0.6965       238
     neutral     0.3220    0.4524    0.3762        84

    accuracy                         0.7150       800
   macro avg     0.6150    0.6491    0.6253       800
weighted avg     0.7492    0.7150    0.7266       800


Confusion Matrix:
[[355  70  53]
 [ 32 179  27]
 [ 19  27  38]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/clipfusion/lr1e-4_bs16_freeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.6455 | Final val weighted-F1: 0.7441 | Final val acc: 0.7362

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.8780    0.7678    0.8192       478
    negative     0.6619    0.7731    0.7132       238
     neutral     0.3654    0.4524    0.4043        84

    accuracy                         0.7362       800
   macro avg     0.6351    0.6644    0.6455       800
weighted avg     0.7599    0.7362    0.7441       800


Final Confusion Matrix:
[[367  68  43]
 [ 31 184  23]
 [ 20  26  38]]

===== Error Analysis =====
Total misclassified samples: 211
Error rate: 0.2637
Saved error analysis to: results/clipfusion/lr1e-4_bs16_freeze\error_analysis.json
Saved final report to: results/clipfusion/lr1e-4_bs16_freeze\final_report.txt

All results saved to: results/clipfusion/lr1e-4_bs16_freeze
