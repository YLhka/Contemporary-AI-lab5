Training started at: 2026-01-28 13:49:28
Command: train_clipfusion_full.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 16 --lr 1e-4 --output-dir results/clipfusion/lr1e-4_bs16_nofreeze --output best_clipfusion_lr1e-4_bs16_nofreeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0927 | Val loss: 1.1366
Val macro-F1: 0.1529 | Val weighted-F1: 0.1364 | Val acc: 0.2975

Classification Report:
              precision    recall  f1-score   support

    positive     0.0000    0.0000    0.0000       478
    negative     0.2975    1.0000    0.4586       238
     neutral     0.0000    0.0000    0.0000        84

    accuracy                         0.2975       800
   macro avg     0.0992    0.3333    0.1529       800
weighted avg     0.0885    0.2975    0.1364       800


Confusion Matrix:
[[  0 478   0]
 [  0 238   0]
 [  0  84   0]]

Saved best model: best_clipfusion_lr1e-4_bs16_nofreeze.pt
===== Epoch 2 =====
Train loss: 1.1009 | Val loss: 1.0777
Val macro-F1: 0.3502 | Val weighted-F1: 0.4774 | Val acc: 0.4975

Classification Report:
              precision    recall  f1-score   support

    positive     0.7574    0.4310    0.5493       478
    negative     0.3636    0.8067    0.5013       238
     neutral     0.0000    0.0000    0.0000        84

    accuracy                         0.4975       800
   macro avg     0.3737    0.4126    0.3502       800
weighted avg     0.5607    0.4975    0.4774       800


Confusion Matrix:
[[206 272   0]
 [ 46 192   0]
 [ 20  64   0]]

Saved best model: best_clipfusion_lr1e-4_bs16_nofreeze.pt
===== Epoch 3 =====
Train loss: 1.0492 | Val loss: 1.0887
Val macro-F1: 0.3683 | Val weighted-F1: 0.4765 | Val acc: 0.4562

Classification Report:
              precision    recall  f1-score   support

    positive     0.8000    0.4184    0.5495       478
    negative     0.3628    0.6555    0.4671       238
     neutral     0.0750    0.1071    0.0882        84

    accuracy                         0.4562       800
   macro avg     0.4126    0.3937    0.3683       800
weighted avg     0.5938    0.4562    0.4765       800


Confusion Matrix:
[[200 211  67]
 [ 38 156  44]
 [ 12  63   9]]

Saved best model: best_clipfusion_lr1e-4_bs16_nofreeze.pt
===== Epoch 4 =====
Train loss: 0.9011 | Val loss: 1.4261
Val macro-F1: 0.3999 | Val weighted-F1: 0.5370 | Val acc: 0.5463

Classification Report:
              precision    recall  f1-score   support

    positive     0.6962    0.6088    0.6496       478
    negative     0.3923    0.5966    0.4733       238
     neutral     0.2000    0.0476    0.0769        84

    accuracy                         0.5463       800
   macro avg     0.4295    0.4177    0.3999       800
weighted avg     0.5537    0.5463    0.5370       800


Confusion Matrix:
[[291 181   6]
 [ 86 142  10]
 [ 41  39   4]]

Saved best model: best_clipfusion_lr1e-4_bs16_nofreeze.pt
===== Epoch 5 =====
Train loss: 0.7598 | Val loss: 1.2269
Val macro-F1: 0.3821 | Val weighted-F1: 0.5568 | Val acc: 0.5900

Classification Report:
              precision    recall  f1-score   support

    positive     0.6797    0.7636    0.7192       478
    negative     0.4068    0.4496    0.4271       238
     neutral     0.0000    0.0000    0.0000        84

    accuracy                         0.5900       800
   macro avg     0.3622    0.4044    0.3821       800
weighted avg     0.5272    0.5900    0.5568       800


Confusion Matrix:
[[365 113   0]
 [131 107   0]
 [ 41  43   0]]

Early stopping counter: 1/3
===== Epoch 6 =====
Train loss: 0.6751 | Val loss: 1.6614
Val macro-F1: 0.3920 | Val weighted-F1: 0.5430 | Val acc: 0.5600

Classification Report:
              precision    recall  f1-score   support

    positive     0.6751    0.7259    0.6996       478
    negative     0.3765    0.4034    0.3895       238
     neutral     0.1613    0.0595    0.0870        84

    accuracy                         0.5600       800
   macro avg     0.4043    0.3963    0.3920       800
weighted avg     0.5323    0.5600    0.5430       800


Confusion Matrix:
[[347 117  14]
 [130  96  12]
 [ 37  42   5]]

Early stopping counter: 2/3
===== Epoch 7 =====
Train loss: 0.6404 | Val loss: 1.4499
Val macro-F1: 0.3628 | Val weighted-F1: 0.5059 | Val acc: 0.5200

Classification Report:
              precision    recall  f1-score   support

    positive     0.7351    0.5167    0.6069       478
    negative     0.3642    0.7101    0.4815       238
     neutral     0.0000    0.0000    0.0000        84

    accuracy                         0.5200       800
   macro avg     0.3664    0.4089    0.3628       800
weighted avg     0.5476    0.5200    0.5059       800


Confusion Matrix:
[[247 231   0]
 [ 69 169   0]
 [ 20  64   0]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/clipfusion/lr1e-4_bs16_nofreeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.3999 | Final val weighted-F1: 0.5370 | Final val acc: 0.5463

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.6962    0.6088    0.6496       478
    negative     0.3923    0.5966    0.4733       238
     neutral     0.2000    0.0476    0.0769        84

    accuracy                         0.5463       800
   macro avg     0.4295    0.4177    0.3999       800
weighted avg     0.5537    0.5463    0.5370       800


Final Confusion Matrix:
[[291 181   6]
 [ 86 142  10]
 [ 41  39   4]]

===== Error Analysis =====
Total misclassified samples: 363
Error rate: 0.4537
Saved error analysis to: results/clipfusion/lr1e-4_bs16_nofreeze\error_analysis.json
Saved final report to: results/clipfusion/lr1e-4_bs16_nofreeze\final_report.txt

All results saved to: results/clipfusion/lr1e-4_bs16_nofreeze
