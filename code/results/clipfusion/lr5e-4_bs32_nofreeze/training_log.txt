Training started at: 2026-01-28 15:19:46
Command: train_clipfusion_full.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 32 --lr 5e-4 --output-dir results/clipfusion/lr5e-4_bs32_nofreeze --output best_clipfusion_lr5e-4_bs32_nofreeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.1121 | Val loss: 1.0996
Val macro-F1: 0.3514 | Val weighted-F1: 0.5270 | Val acc: 0.5800

Classification Report:
              precision    recall  f1-score   support

    positive     0.6254    0.8243    0.7112       478
    negative     0.4118    0.2941    0.3431       238
     neutral     0.0000    0.0000    0.0000        84

    accuracy                         0.5800       800
   macro avg     0.3457    0.3728    0.3514       800
weighted avg     0.4962    0.5800    0.5270       800


Confusion Matrix:
[[394  84   0]
 [168  70   0]
 [ 68  16   0]]

Saved best model: best_clipfusion_lr5e-4_bs32_nofreeze.pt
===== Epoch 2 =====
Train loss: 1.1186 | Val loss: 1.0966
Val macro-F1: 0.1527 | Val weighted-F1: 0.1362 | Val acc: 0.2963

Classification Report:
              precision    recall  f1-score   support

    positive     0.0000    0.0000    0.0000       478
    negative     0.2974    0.9958    0.4580       238
     neutral     0.0000    0.0000    0.0000        84

    accuracy                         0.2963       800
   macro avg     0.0991    0.3319    0.1527       800
weighted avg     0.0885    0.2963    0.1362       800


Confusion Matrix:
[[  0 476   2]
 [  0 237   1]
 [  0  84   0]]

Early stopping counter: 1/3
===== Epoch 3 =====
Train loss: 1.1072 | Val loss: 1.0995
Val macro-F1: 0.2754 | Val weighted-F1: 0.4547 | Val acc: 0.5938

Classification Report:
              precision    recall  f1-score   support

    positive     0.6015    0.9854    0.7470       478
    negative     0.0000    0.0000    0.0000       238
     neutral     0.2353    0.0476    0.0792        84

    accuracy                         0.5938       800
   macro avg     0.2789    0.3443    0.2754       800
weighted avg     0.3841    0.5938    0.4547       800


Confusion Matrix:
[[471   0   7]
 [232   0   6]
 [ 80   0   4]]

Early stopping counter: 2/3
===== Epoch 4 =====
Train loss: 1.0975 | Val loss: 1.1037
Val macro-F1: 0.3096 | Val weighted-F1: 0.4890 | Val acc: 0.5550

Classification Report:
              precision    recall  f1-score   support

    positive     0.6128    0.8410    0.7090       478
    negative     0.2917    0.1765    0.2199       238
     neutral     0.0000    0.0000    0.0000        84

    accuracy                         0.5550       800
   macro avg     0.3015    0.3392    0.3096       800
weighted avg     0.4529    0.5550    0.4890       800


Confusion Matrix:
[[402  76   0]
 [196  42   0]
 [ 58  26   0]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/clipfusion/lr5e-4_bs32_nofreeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.3514 | Final val weighted-F1: 0.5270 | Final val acc: 0.5800

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.6254    0.8243    0.7112       478
    negative     0.4118    0.2941    0.3431       238
     neutral     0.0000    0.0000    0.0000        84

    accuracy                         0.5800       800
   macro avg     0.3457    0.3728    0.3514       800
weighted avg     0.4962    0.5800    0.5270       800


Final Confusion Matrix:
[[394  84   0]
 [168  70   0]
 [ 68  16   0]]

===== Error Analysis =====
Total misclassified samples: 336
Error rate: 0.4200
Saved error analysis to: results/clipfusion/lr5e-4_bs32_nofreeze\error_analysis.json
Saved final report to: results/clipfusion/lr5e-4_bs32_nofreeze\final_report.txt

All results saved to: results/clipfusion/lr5e-4_bs32_nofreeze
