Training started at: 2026-01-28 15:11:26
Command: train_clipfusion_full.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 32 --lr 5e-4 --freeze-clip --output-dir results/clipfusion/lr5e-4_bs32_freeze --output best_clipfusion_lr5e-4_bs32_freeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 0.9244 | Val loss: 0.8111
Val macro-F1: 0.5801 | Val weighted-F1: 0.6678 | Val acc: 0.6550

Classification Report:
              precision    recall  f1-score   support

    positive     0.9283    0.5962    0.7261       478
    negative     0.5397    0.8571    0.6623       238
     neutral     0.3043    0.4167    0.3518        84

    accuracy                         0.6550       800
   macro avg     0.5908    0.6233    0.5801       800
weighted avg     0.7472    0.6550    0.6678       800


Confusion Matrix:
[[285 133  60]
 [ 14 204  20]
 [  8  41  35]]

Saved best model: best_clipfusion_lr5e-4_bs32_freeze.pt
===== Epoch 2 =====
Train loss: 0.6890 | Val loss: 0.7676
Val macro-F1: 0.6061 | Val weighted-F1: 0.7009 | Val acc: 0.6850

Classification Report:
              precision    recall  f1-score   support

    positive     0.8877    0.6778    0.7687       478
    negative     0.6113    0.7731    0.6827       238
     neutral     0.2985    0.4762    0.3670        84

    accuracy                         0.6850       800
   macro avg     0.5992    0.6424    0.6061       800
weighted avg     0.7436    0.6850    0.7009       800


Confusion Matrix:
[[324  89  65]
 [ 25 184  29]
 [ 16  28  40]]

Saved best model: best_clipfusion_lr5e-4_bs32_freeze.pt
===== Epoch 3 =====
Train loss: 0.5476 | Val loss: 0.7819
Val macro-F1: 0.6136 | Val weighted-F1: 0.7006 | Val acc: 0.6800

Classification Report:
              precision    recall  f1-score   support

    positive     0.9070    0.6527    0.7591       478
    negative     0.6280    0.7731    0.6930       238
     neutral     0.2945    0.5714    0.3887        84

    accuracy                         0.6800       800
   macro avg     0.6098    0.6658    0.6136       800
weighted avg     0.7597    0.6800    0.7006       800


Confusion Matrix:
[[312  83  83]
 [ 22 184  32]
 [ 10  26  48]]

Saved best model: best_clipfusion_lr5e-4_bs32_freeze.pt
===== Epoch 4 =====
Train loss: 0.4467 | Val loss: 0.9297
Val macro-F1: 0.6266 | Val weighted-F1: 0.7312 | Val acc: 0.7200

Classification Report:
              precision    recall  f1-score   support

    positive     0.8595    0.7678    0.8110       478
    negative     0.6786    0.7185    0.6980       238
     neutral     0.3140    0.4524    0.3707        84

    accuracy                         0.7200       800
   macro avg     0.6174    0.6462    0.6266       800
weighted avg     0.7484    0.7200    0.7312       800


Confusion Matrix:
[[367  57  54]
 [ 38 171  29]
 [ 22  24  38]]

Saved best model: best_clipfusion_lr5e-4_bs32_freeze.pt
===== Epoch 5 =====
Train loss: 0.3882 | Val loss: 1.0193
Val macro-F1: 0.6184 | Val weighted-F1: 0.7243 | Val acc: 0.7163

Classification Report:
              precision    recall  f1-score   support

    positive     0.8356    0.7762    0.8048       478
    negative     0.6816    0.7017    0.6915       238
     neutral     0.3153    0.4167    0.3590        84

    accuracy                         0.7162       800
   macro avg     0.6108    0.6315    0.6184       800
weighted avg     0.7352    0.7163    0.7243       800


Confusion Matrix:
[[371  55  52]
 [ 47 167  24]
 [ 26  23  35]]

Early stopping counter: 1/3
===== Epoch 6 =====
Train loss: 0.3296 | Val loss: 1.0917
Val macro-F1: 0.6179 | Val weighted-F1: 0.7221 | Val acc: 0.7100

Classification Report:
              precision    recall  f1-score   support

    positive     0.8512    0.7657    0.8062       478
    negative     0.6708    0.6849    0.6778       238
     neutral     0.3071    0.4643    0.3697        84

    accuracy                         0.7100       800
   macro avg     0.6097    0.6383    0.6179       800
weighted avg     0.7404    0.7100    0.7221       800


Confusion Matrix:
[[366  57  55]
 [ 42 163  33]
 [ 22  23  39]]

Early stopping counter: 2/3
===== Epoch 7 =====
Train loss: 0.2820 | Val loss: 1.2511
Val macro-F1: 0.6113 | Val weighted-F1: 0.7170 | Val acc: 0.7100

Classification Report:
              precision    recall  f1-score   support

    positive     0.8406    0.7615    0.7991       478
    negative     0.6453    0.7185    0.6799       238
     neutral     0.3235    0.3929    0.3548        84

    accuracy                         0.7100       800
   macro avg     0.6032    0.6243    0.6113       800
weighted avg     0.7282    0.7100    0.7170       800


Confusion Matrix:
[[364  66  48]
 [ 46 171  21]
 [ 23  28  33]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/clipfusion/lr5e-4_bs32_freeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.6266 | Final val weighted-F1: 0.7312 | Final val acc: 0.7200

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.8595    0.7678    0.8110       478
    negative     0.6786    0.7185    0.6980       238
     neutral     0.3140    0.4524    0.3707        84

    accuracy                         0.7200       800
   macro avg     0.6174    0.6462    0.6266       800
weighted avg     0.7484    0.7200    0.7312       800


Final Confusion Matrix:
[[367  57  54]
 [ 38 171  29]
 [ 22  24  38]]

===== Error Analysis =====
Total misclassified samples: 224
Error rate: 0.2800
Saved error analysis to: results/clipfusion/lr5e-4_bs32_freeze\error_analysis.json
Saved final report to: results/clipfusion/lr5e-4_bs32_freeze\final_report.txt

All results saved to: results/clipfusion/lr5e-4_bs32_freeze
