Training started at: 2026-01-28 16:00:21
Command: train_baselines.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --mode image --epochs 10 --batch-size 32 --lr 1e-4 --output-dir results/baselines/image_only --output-path best_image_only.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0268 | Val loss: 0.9780
Val macro-F1: 0.4823 | Val weighted-F1: 0.5446 | Val acc: 0.5225

Classification Report:
              precision    recall  f1-score   support

    positive     0.8152    0.4707    0.5968       478
    negative     0.4388    0.6176    0.5131       238
     neutral     0.2434    0.5476    0.3370        84

    accuracy                         0.5225       800
   macro avg     0.4991    0.5453    0.4823       800
weighted avg     0.6432    0.5225    0.5446       800


Confusion Matrix:
[[225 160  93]
 [ 41 147  50]
 [ 10  28  46]]

Saved best model: best_image_baseline.pt
===== Epoch 2 =====
Train loss: 0.9375 | Val loss: 1.0253
Val macro-F1: 0.3735 | Val weighted-F1: 0.3861 | Val acc: 0.4088

Classification Report:
              precision    recall  f1-score   support

    positive     0.7883    0.2259    0.3512       478
    negative     0.3615    0.7899    0.4960       238
     neutral     0.2168    0.3690    0.2731        84

    accuracy                         0.4088       800
   macro avg     0.4555    0.4616    0.3735       800
weighted avg     0.6013    0.4088    0.3861       800


Confusion Matrix:
[[108 290  80]
 [ 18 188  32]
 [ 11  42  31]]

Early stopping counter: 1/3
===== Epoch 3 =====
Train loss: 0.8973 | Val loss: 0.9736
Val macro-F1: 0.4776 | Val weighted-F1: 0.5346 | Val acc: 0.5075

Classification Report:
              precision    recall  f1-score   support

    positive     0.7847    0.4498    0.5718       478
    negative     0.5019    0.5672    0.5325       238
     neutral     0.2179    0.6667    0.3284        84

    accuracy                         0.5075       800
   macro avg     0.5015    0.5612    0.4776       800
weighted avg     0.6410    0.5075    0.5346       800


Confusion Matrix:
[[215 118 145]
 [ 47 135  56]
 [ 12  16  56]]

Early stopping counter: 2/3
===== Epoch 4 =====
Train loss: 0.8595 | Val loss: 1.1290
Val macro-F1: 0.4887 | Val weighted-F1: 0.5794 | Val acc: 0.5575

Classification Report:
              precision    recall  f1-score   support

    positive     0.7379    0.6360    0.6831       478
    negative     0.5750    0.3866    0.4623       238
     neutral     0.2193    0.5952    0.3205        84

    accuracy                         0.5575       800
   macro avg     0.5107    0.5393    0.4887       800
weighted avg     0.6350    0.5575    0.5794       800


Confusion Matrix:
[[304  54 120]
 [ 88  92  58]
 [ 20  14  50]]

Saved best model: best_image_baseline.pt
===== Epoch 5 =====
Train loss: 0.7911 | Val loss: 1.3111
Val macro-F1: 0.4158 | Val weighted-F1: 0.5450 | Val acc: 0.5537

Classification Report:
              precision    recall  f1-score   support

    positive     0.6785    0.7594    0.7167       478
    negative     0.5521    0.2227    0.3174       238
     neutral     0.1598    0.3214    0.2134        84

    accuracy                         0.5537       800
   macro avg     0.4635    0.4345    0.4158       800
weighted avg     0.5864    0.5537    0.5450       800


Confusion Matrix:
[[363  30  85]
 [128  53  57]
 [ 44  13  27]]

Early stopping counter: 1/3
===== Epoch 6 =====
Train loss: 0.7619 | Val loss: 1.2787
Val macro-F1: 0.4694 | Val weighted-F1: 0.5674 | Val acc: 0.5437

Classification Report:
              precision    recall  f1-score   support

    positive     0.7475    0.6255    0.6811       478
    negative     0.4947    0.3908    0.4366       238
     neutral     0.2028    0.5119    0.2905        84

    accuracy                         0.5437       800
   macro avg     0.4817    0.5094    0.4694       800
weighted avg     0.6151    0.5437    0.5674       800


Confusion Matrix:
[[299  75 104]
 [ 80  93  65]
 [ 21  20  43]]

Early stopping counter: 2/3
===== Epoch 7 =====
Train loss: 0.7422 | Val loss: 1.2190
Val macro-F1: 0.4541 | Val weighted-F1: 0.5212 | Val acc: 0.5062

Classification Report:
              precision    recall  f1-score   support

    positive     0.7799    0.4372    0.5603       478
    negative     0.4316    0.6891    0.5307       238
     neutral     0.2105    0.3810    0.2712        84

    accuracy                         0.5062       800
   macro avg     0.4740    0.5024    0.4541       800
weighted avg     0.6165    0.5062    0.5212       800


Confusion Matrix:
[[209 181  88]
 [ 42 164  32]
 [ 17  35  32]]

Early stopping counter: 3/3
Early stopping triggered!
Best val macro-F1: 0.4887
Saved metrics to: results/baselines/image_only\image\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.4887 | Final val weighted-F1: 0.5794 | Final val acc: 0.5575

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.7379    0.6360    0.6831       478
    negative     0.5750    0.3866    0.4623       238
     neutral     0.2193    0.5952    0.3205        84

    accuracy                         0.5575       800
   macro avg     0.5107    0.5393    0.4887       800
weighted avg     0.6350    0.5575    0.5794       800


Final Confusion Matrix:
[[304  54 120]
 [ 88  92  58]
 [ 20  14  50]]
Saved final report to: results/baselines/image_only\image\final_report.txt

All results saved to: results/baselines/image_only\image
