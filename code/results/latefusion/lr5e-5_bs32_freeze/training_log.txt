Training started at: 2026-01-28 13:17:28
Command: train_latefusion.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 32 --lr 5e-5 --freeze-text --output-dir results/latefusion/lr5e-5_bs32_freeze --output-path best_latefusion_lr5e-5_bs32_freeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0495
Val macro-F1: 0.5045 | Val weighted-F1: 0.6084 | Val acc: 0.6025

Classification Report:
              precision    recall  f1-score   support

    positive     0.7352    0.7259    0.7305       478
    negative     0.5236    0.4202    0.4662       238
     neutral     0.2555    0.4167    0.3167        84

    accuracy                         0.6025       800
   macro avg     0.5047    0.5209    0.5045       800
weighted avg     0.6218    0.6025    0.6084       800


Confusion Matrix:
[[347  69  62]
 [ 98 100  40]
 [ 27  22  35]]

Saved best model: best_latefusion_lr5e-5_bs32_freeze.pt
===== Epoch 2 =====
Train loss: 0.9188
Val macro-F1: 0.5295 | Val weighted-F1: 0.6171 | Val acc: 0.5950

Classification Report:
              precision    recall  f1-score   support

    positive     0.7962    0.6213    0.6980       478
    negative     0.5400    0.5672    0.5533       238
     neutral     0.2486    0.5238    0.3372        84

    accuracy                         0.5950       800
   macro avg     0.5283    0.5708    0.5295       800
weighted avg     0.6625    0.5950    0.6171       800


Confusion Matrix:
[[297  91  90]
 [ 60 135  43]
 [ 16  24  44]]

Saved best model: best_latefusion_lr5e-5_bs32_freeze.pt
===== Epoch 3 =====
Train loss: 0.8063
Val macro-F1: 0.4639 | Val weighted-F1: 0.5293 | Val acc: 0.5025

Classification Report:
              precision    recall  f1-score   support

    positive     0.8263    0.4477    0.5807       478
    negative     0.4369    0.5966    0.5044       238
     neutral     0.2130    0.5476    0.3067        84

    accuracy                         0.5025       800
   macro avg     0.4920    0.5307    0.4639       800
weighted avg     0.6460    0.5025    0.5293       800


Confusion Matrix:
[[214 152 112]
 [ 38 142  58]
 [  7  31  46]]

Early stopping counter: 1/3
===== Epoch 4 =====
Train loss: 0.7053
Val macro-F1: 0.4771 | Val weighted-F1: 0.5356 | Val acc: 0.5100

Classification Report:
              precision    recall  f1-score   support

    positive     0.8468    0.4393    0.5785       478
    negative     0.4534    0.6134    0.5214       238
     neutral     0.2261    0.6190    0.3312        84

    accuracy                         0.5100       800
   macro avg     0.5088    0.5573    0.4771       800
weighted avg     0.6646    0.5100    0.5356       800


Confusion Matrix:
[[210 152 116]
 [ 30 146  62]
 [  8  24  52]]

Early stopping counter: 2/3
===== Epoch 5 =====
Train loss: 0.6147
Val macro-F1: 0.5319 | Val weighted-F1: 0.6218 | Val acc: 0.6025

Classification Report:
              precision    recall  f1-score   support

    positive     0.7852    0.6423    0.7066       478
    negative     0.5451    0.5588    0.5519       238
     neutral     0.2545    0.5000    0.3373        84

    accuracy                         0.6025       800
   macro avg     0.5283    0.5670    0.5319       800
weighted avg     0.6580    0.6025    0.6218       800


Confusion Matrix:
[[307  90  81]
 [ 63 133  42]
 [ 21  21  42]]

Saved best model: best_latefusion_lr5e-5_bs32_freeze.pt
===== Epoch 6 =====
Train loss: 0.5153
Val macro-F1: 0.5254 | Val weighted-F1: 0.6266 | Val acc: 0.6212

Classification Report:
              precision    recall  f1-score   support

    positive     0.7362    0.7238    0.7300       478
    negative     0.5587    0.5000    0.5277       238
     neutral     0.2735    0.3810    0.3184        84

    accuracy                         0.6212       800
   macro avg     0.5228    0.5349    0.5254       800
weighted avg     0.6348    0.6212    0.6266       800


Confusion Matrix:
[[346  76  56]
 [ 90 119  29]
 [ 34  18  32]]

Early stopping counter: 1/3
===== Epoch 7 =====
Train loss: 0.4388
Val macro-F1: 0.5128 | Val weighted-F1: 0.6335 | Val acc: 0.6375

Classification Report:
              precision    recall  f1-score   support

    positive     0.7318    0.7762    0.7533       478
    negative     0.5625    0.4916    0.5247       238
     neutral     0.2588    0.2619    0.2604        84

    accuracy                         0.6375       800
   macro avg     0.5177    0.5099    0.5128       800
weighted avg     0.6317    0.6375    0.6335       800


Confusion Matrix:
[[371  69  38]
 [ 96 117  25]
 [ 40  22  22]]

Early stopping counter: 2/3
===== Epoch 8 =====
Train loss: 0.3855
Val macro-F1: 0.5138 | Val weighted-F1: 0.6275 | Val acc: 0.6262

Classification Report:
              precision    recall  f1-score   support

    positive     0.7416    0.7385    0.7400       478
    negative     0.5299    0.5210    0.5254       238
     neutral     0.2667    0.2857    0.2759        84

    accuracy                         0.6262       800
   macro avg     0.5127    0.5151    0.5138       800
weighted avg     0.6288    0.6262    0.6275       800


Confusion Matrix:
[[353  84  41]
 [ 89 124  25]
 [ 34  26  24]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/latefusion/lr5e-5_bs32_freeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.5319
Final val weighted-F1: 0.6218
Final val acc: 0.6025

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.7852    0.6423    0.7066       478
    negative     0.5451    0.5588    0.5519       238
     neutral     0.2545    0.5000    0.3373        84

    accuracy                         0.6025       800
   macro avg     0.5283    0.5670    0.5319       800
weighted avg     0.6580    0.6025    0.6218       800


Final Confusion Matrix:
[[307  90  81]
 [ 63 133  42]
 [ 21  21  42]]
Saved final report to: results/latefusion/lr5e-5_bs32_freeze\final_report.txt

All results saved to: results/latefusion/lr5e-5_bs32_freeze
