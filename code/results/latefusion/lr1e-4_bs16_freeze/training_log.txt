Training started at: 2026-01-28 12:14:54
Command: train_latefusion.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 16 --lr 1e-4 --freeze-text --output-dir results/latefusion/lr1e-4_bs16_freeze --output-path best_latefusion_lr1e-4_bs16_freeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0537
Val macro-F1: 0.3879 | Val weighted-F1: 0.4235 | Val acc: 0.4350

Classification Report:
              precision    recall  f1-score   support

    positive     0.8471    0.2782    0.4189       478
    negative     0.3563    0.8025    0.4935       238
     neutral     0.2243    0.2857    0.2513        84

    accuracy                         0.4350       800
   macro avg     0.4759    0.4555    0.3879       800
weighted avg     0.6357    0.4350    0.4235       800


Confusion Matrix:
[[133 290  55]
 [ 19 191  28]
 [  5  55  24]]

Saved best model: best_latefusion_lr1e-4_bs16_freeze.pt
===== Epoch 2 =====
Train loss: 1.0124
Val macro-F1: 0.4088 | Val weighted-F1: 0.4573 | Val acc: 0.4238

Classification Report:
              precision    recall  f1-score   support

    positive     0.7788    0.3536    0.4863       478
    negative     0.4587    0.4664    0.4625       238
     neutral     0.1730    0.7024    0.2776        84

    accuracy                         0.4238       800
   macro avg     0.4702    0.5074    0.4088       800
weighted avg     0.6200    0.4238    0.4573       800


Confusion Matrix:
[[169 115 194]
 [ 39 111  88]
 [  9  16  59]]

Saved best model: best_latefusion_lr1e-4_bs16_freeze.pt
===== Epoch 3 =====
Train loss: 0.9485
Val macro-F1: 0.4745 | Val weighted-F1: 0.5518 | Val acc: 0.5288

Classification Report:
              precision    recall  f1-score   support

    positive     0.7613    0.5272    0.6230       478
    negative     0.4517    0.5504    0.4962       238
     neutral     0.2235    0.4762    0.3042        84

    accuracy                         0.5288       800
   macro avg     0.4788    0.5179    0.4745       800
weighted avg     0.6127    0.5288    0.5518       800


Confusion Matrix:
[[252 135  91]
 [ 59 131  48]
 [ 20  24  40]]

Saved best model: best_latefusion_lr1e-4_bs16_freeze.pt
===== Epoch 4 =====
Train loss: 0.9185
Val macro-F1: 0.4046 | Val weighted-F1: 0.4210 | Val acc: 0.4300

Classification Report:
              precision    recall  f1-score   support

    positive     0.8182    0.2636    0.3987       478
    negative     0.3834    0.7395    0.5050       238
     neutral     0.2246    0.5000    0.3100        84

    accuracy                         0.4300       800
   macro avg     0.4754    0.5010    0.4046       800
weighted avg     0.6265    0.4300    0.4210       800


Confusion Matrix:
[[126 249 103]
 [ 20 176  42]
 [  8  34  42]]

Early stopping counter: 1/3
===== Epoch 5 =====
Train loss: 0.8835
Val macro-F1: 0.5080 | Val weighted-F1: 0.6064 | Val acc: 0.5913

Classification Report:
              precision    recall  f1-score   support

    positive     0.7483    0.6715    0.7078       478
    negative     0.5349    0.4832    0.5077       238
     neutral     0.2372    0.4405    0.3083        84

    accuracy                         0.5913       800
   macro avg     0.5068    0.5317    0.5080       800
weighted avg     0.6311    0.5913    0.6064       800


Confusion Matrix:
[[321  78  79]
 [ 83 115  40]
 [ 25  22  37]]

Saved best model: best_latefusion_lr1e-4_bs16_freeze.pt
===== Epoch 6 =====
Train loss: 0.7943
Val macro-F1: 0.4912 | Val weighted-F1: 0.5665 | Val acc: 0.5463

Classification Report:
              precision    recall  f1-score   support

    positive     0.8194    0.5126    0.6306       478
    negative     0.4403    0.6513    0.5254       238
     neutral     0.2483    0.4405    0.3176        84

    accuracy                         0.5463       800
   macro avg     0.5027    0.5348    0.4912       800
weighted avg     0.6467    0.5463    0.5665       800


Confusion Matrix:
[[245 159  74]
 [ 45 155  38]
 [  9  38  37]]

Early stopping counter: 1/3
===== Epoch 7 =====
Train loss: 0.7395
Val macro-F1: 0.4971 | Val weighted-F1: 0.5795 | Val acc: 0.5613

Classification Report:
              precision    recall  f1-score   support

    positive     0.7939    0.5481    0.6485       478
    negative     0.4622    0.6429    0.5378       238
     neutral     0.2446    0.4048    0.3049        84

    accuracy                         0.5613       800
   macro avg     0.5003    0.5319    0.4971       800
weighted avg     0.6376    0.5613    0.5795       800


Confusion Matrix:
[[262 146  70]
 [ 50 153  35]
 [ 18  32  34]]

Early stopping counter: 2/3
===== Epoch 8 =====
Train loss: 0.6536
Val macro-F1: 0.4842 | Val weighted-F1: 0.5621 | Val acc: 0.5450

Classification Report:
              precision    recall  f1-score   support

    positive     0.7994    0.5167    0.6277       478
    negative     0.4313    0.6597    0.5216       238
     neutral     0.2520    0.3810    0.3033        84

    accuracy                         0.5450       800
   macro avg     0.4942    0.5191    0.4842       800
weighted avg     0.6324    0.5450    0.5621       800


Confusion Matrix:
[[247 169  62]
 [ 48 157  33]
 [ 14  38  32]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/latefusion/lr1e-4_bs16_freeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.5080
Final val weighted-F1: 0.6064
Final val acc: 0.5913

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.7483    0.6715    0.7078       478
    negative     0.5349    0.4832    0.5077       238
     neutral     0.2372    0.4405    0.3083        84

    accuracy                         0.5913       800
   macro avg     0.5068    0.5317    0.5080       800
weighted avg     0.6311    0.5913    0.6064       800


Final Confusion Matrix:
[[321  78  79]
 [ 83 115  40]
 [ 25  22  37]]
Saved final report to: results/latefusion/lr1e-4_bs16_freeze\final_report.txt

All results saved to: results/latefusion/lr1e-4_bs16_freeze
