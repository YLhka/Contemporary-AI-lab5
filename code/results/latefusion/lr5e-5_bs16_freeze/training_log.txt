Training started at: 2026-01-28 13:00:29
Command: train_latefusion.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 16 --lr 5e-5 --freeze-text --output-dir results/latefusion/lr5e-5_bs16_freeze --output-path best_latefusion_lr5e-5_bs16_freeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0460
Val macro-F1: 0.4829 | Val weighted-F1: 0.5539 | Val acc: 0.5375

Classification Report:
              precision    recall  f1-score   support

    positive     0.7960    0.4979    0.6126       478
    negative     0.4270    0.6639    0.5197       238
     neutral     0.2595    0.4048    0.3163        84

    accuracy                         0.5375       800
   macro avg     0.4942    0.5222    0.4829       800
weighted avg     0.6299    0.5375    0.5539       800


Confusion Matrix:
[[238 174  66]
 [ 49 158  31]
 [ 12  38  34]]

Saved best model: best_latefusion_lr5e-5_bs16_freeze.pt
===== Epoch 2 =====
Train loss: 0.9505
Val macro-F1: 0.4325 | Val weighted-F1: 0.4675 | Val acc: 0.4600

Classification Report:
              precision    recall  f1-score   support

    positive     0.8377    0.3347    0.4783       478
    negative     0.3873    0.6933    0.4970       238
     neutral     0.2350    0.5119    0.3221        84

    accuracy                         0.4600       800
   macro avg     0.4867    0.5133    0.4325       800
weighted avg     0.6404    0.4600    0.4675       800


Confusion Matrix:
[[160 226  92]
 [ 25 165  48]
 [  6  35  43]]

Early stopping counter: 1/3
===== Epoch 3 =====
Train loss: 0.8543
Val macro-F1: 0.4501 | Val weighted-F1: 0.5018 | Val acc: 0.4863

Classification Report:
              precision    recall  f1-score   support

    positive     0.8083    0.4059    0.5404       478
    negative     0.3881    0.6555    0.4875       238
     neutral     0.2468    0.4643    0.3223        84

    accuracy                         0.4863       800
   macro avg     0.4811    0.5085    0.4501       800
weighted avg     0.6243    0.4863    0.5018       800


Confusion Matrix:
[[194 212  72]
 [ 35 156  47]
 [ 11  34  39]]

Early stopping counter: 2/3
===== Epoch 4 =====
Train loss: 0.8031
Val macro-F1: 0.4590 | Val weighted-F1: 0.5134 | Val acc: 0.4938

Classification Report:
              precision    recall  f1-score   support

    positive     0.8115    0.4142    0.5485       478
    negative     0.4282    0.6387    0.5126       238
     neutral     0.2239    0.5357    0.3158        84

    accuracy                         0.4938       800
   macro avg     0.4878    0.5295    0.4590       800
weighted avg     0.6357    0.4938    0.5134       800


Confusion Matrix:
[[198 172 108]
 [ 38 152  48]
 [  8  31  45]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/latefusion/lr5e-5_bs16_freeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.4829
Final val weighted-F1: 0.5539
Final val acc: 0.5375

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.7960    0.4979    0.6126       478
    negative     0.4270    0.6639    0.5197       238
     neutral     0.2595    0.4048    0.3163        84

    accuracy                         0.5375       800
   macro avg     0.4942    0.5222    0.4829       800
weighted avg     0.6299    0.5375    0.5539       800


Final Confusion Matrix:
[[238 174  66]
 [ 49 158  31]
 [ 12  38  34]]
Saved final report to: results/latefusion/lr5e-5_bs16_freeze\final_report.txt

All results saved to: results/latefusion/lr5e-5_bs16_freeze
