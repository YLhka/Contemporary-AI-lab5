Training started at: 2026-01-28 12:51:12
Command: train_latefusion.py --train-file cleaned/train_clean.txt --val-file cleaned/val_clean.txt --data-dir data --epochs 10 --batch-size 16 --lr 1e-4 --output-dir results/latefusion/lr1e-4_bs16_nofreeze --output-path best_latefusion_lr1e-4_bs16_nofreeze.pt

Device: cuda
PyTorch version: 2.6.0+cu124
CUDA version: 12.4
GPU: NVIDIA GeForce RTX 4060 Laptop GPU
Class weights: [0.5584642291069031, 1.1169284582138062, 3.184079647064209]
===== Epoch 1 =====
Train loss: 1.0507
Val macro-F1: 0.4437 | Val weighted-F1: 0.5263 | Val acc: 0.5212

Classification Report:
              precision    recall  f1-score   support

    positive     0.7900    0.4644    0.5850       478
    negative     0.3886    0.7479    0.5115       238
     neutral     0.2787    0.2024    0.2345        84

    accuracy                         0.5212       800
   macro avg     0.4858    0.4716    0.4437       800
weighted avg     0.6169    0.5212    0.5263       800


Confusion Matrix:
[[222 226  30]
 [ 46 178  14]
 [ 13  54  17]]

Saved best model: best_latefusion_lr1e-4_bs16_nofreeze.pt
===== Epoch 2 =====
Train loss: 1.0071
Val macro-F1: 0.4073 | Val weighted-F1: 0.4360 | Val acc: 0.4175

Classification Report:
              precision    recall  f1-score   support

    positive     0.7684    0.3054    0.4371       478
    negative     0.4390    0.5294    0.4800       238
     neutral     0.1920    0.7381    0.3047        84

    accuracy                         0.4175       800
   macro avg     0.4665    0.5243    0.4073       800
weighted avg     0.6099    0.4175    0.4360       800


Confusion Matrix:
[[146 144 188]
 [ 39 126  73]
 [  5  17  62]]

Early stopping counter: 1/3
===== Epoch 3 =====
Train loss: 0.9391
Val macro-F1: 0.4232 | Val weighted-F1: 0.4776 | Val acc: 0.4637

Classification Report:
              precision    recall  f1-score   support

    positive     0.7645    0.3870    0.5139       478
    negative     0.3750    0.6429    0.4737       238
     neutral     0.2200    0.3929    0.2821        84

    accuracy                         0.4637       800
   macro avg     0.4532    0.4742    0.4232       800
weighted avg     0.5914    0.4637    0.4776       800


Confusion Matrix:
[[185 218  75]
 [ 43 153  42]
 [ 14  37  33]]

Early stopping counter: 2/3
===== Epoch 4 =====
Train loss: 0.9253
Val macro-F1: 0.3958 | Val weighted-F1: 0.4090 | Val acc: 0.4175

Classification Report:
              precision    recall  f1-score   support

    positive     0.8039    0.2573    0.3899       478
    negative     0.3619    0.7101    0.4794       238
     neutral     0.2333    0.5000    0.3182        84

    accuracy                         0.4175       800
   macro avg     0.4664    0.4891    0.3958       800
weighted avg     0.6125    0.4175    0.4090       800


Confusion Matrix:
[[123 264  91]
 [ 22 169  47]
 [  8  34  42]]

Early stopping counter: 3/3
Early stopping triggered!
Saved metrics to: results/latefusion/lr1e-4_bs16_nofreeze\metrics.csv

===== Final Evaluation =====
Final val macro-F1: 0.4437
Final val weighted-F1: 0.5263
Final val acc: 0.5212

Final Classification Report:
              precision    recall  f1-score   support

    positive     0.7900    0.4644    0.5850       478
    negative     0.3886    0.7479    0.5115       238
     neutral     0.2787    0.2024    0.2345        84

    accuracy                         0.5212       800
   macro avg     0.4858    0.4716    0.4437       800
weighted avg     0.6169    0.5212    0.5263       800


Final Confusion Matrix:
[[222 226  30]
 [ 46 178  14]
 [ 13  54  17]]
Saved final report to: results/latefusion/lr1e-4_bs16_nofreeze\final_report.txt

All results saved to: results/latefusion/lr1e-4_bs16_nofreeze
